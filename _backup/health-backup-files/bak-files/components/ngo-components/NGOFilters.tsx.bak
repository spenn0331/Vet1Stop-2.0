"use client";

import React, { useState } from 'react';
import {
  MagnifyingGlassIcon,
  AdjustmentsHorizontalIcon,
  XMarkIcon,
  CheckIcon,
  UserGroupIcon,
  StarIcon
} from '@heroicons/react/24/outline';
import { NGO_FOCUS_AREAS } from '@/utils/ngo-data';

export interface NGOFiltersProps {
  onSearchChange: (query: string) => void;
  onFocusChange: (focusAreas: string[]) => void;
  onLocationChange: (locations: string[]) => void;
  onVeteranFoundedChange: (isVeteranFounded: boolean) => void;
  onVerifiedOnlyChange: (showAllResources: boolean) => void;
  onMinRatingChange: (rating: string) => void;
  onSortByChange: (sortBy: string) => void;
  searchValue: string;
  selectedFocus: string[];
  selectedLocations: string[];
  isVeteranFounded: boolean;
  showAllResources: boolean;
  selectedRating: string;
}

/**
 * NGO Filters Component
 * Provides comprehensive filtering options for NGO resources
 */
const NGOFilters: React.FC<NGOFiltersProps> = ({
  onSearchChange,
  onFocusChange,
  onLocationChange,
  onVeteranFoundedChange,
  onVerifiedOnlyChange,
  onMinRatingChange,
  onSortByChange,
  searchValue,
  selectedFocus,
  selectedLocations,
  isVeteranFounded,
  showAllResources,
  selectedRating
}) => {
  const states = [
    'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware',
    'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky',
    'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri',
    'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York',
    'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island',
    'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington',
    'West Virginia', 'Wisconsin', 'Wyoming'
  ];

  const ratingOptions = [
    { value: 'Any Rating', label: 'Any Rating' },
    { value: '4+', label: '4+ Stars' },
    { value: '3+', label: '3+ Stars' },
    { value: '2+', label: '2+ Stars' },
  ];

  const sortOptions = [
    { value: 'relevance', label: 'Relevance' },
    { value: 'rating', label: 'Highest Rating' },
    { value: 'reviews', label: 'Most Reviews' },
    { value: 'newest', label: 'Newest' },
  ];

  const FilterSection = ({ title, children }: { title: string, children: React.ReactNode }) => (
    <div className="mb-4">
      <h4 className="font-medium text-gray-900 mb-2">{title}</h4>
      <div className="space-y-2">{children}</div>
    </div>
  );

  return (
    <div className="space-y-4">
      <div className="relative">
        <input
          type="text"
          value={searchValue}
          onChange={(e) => onSearchChange(e.target.value)}
          className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
          placeholder="Search NGOs..."
        />
        <MagnifyingGlassIcon className="absolute left-3 top-2.5 h-5 w-5 text-gray-400" />
      </div>

      <FilterSection title="Focus Area">
        <div className="max-h-40 overflow-y-auto">
          {NGO_FOCUS_AREAS.slice(1).map((focus) => (
            <div key={focus.value} className="flex items-center">
              <input
                type="checkbox"
                id={`focus-${focus.value}`}
                checked={selectedFocus.includes(focus.value)}
                onChange={() => {
                  const newFocus = selectedFocus.includes(focus.value)
                    ? selectedFocus.filter(f => f !== focus.value)
                    : [...selectedFocus, focus.value];
                  onFocusChange(newFocus);
                }}
                className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              />
              <label htmlFor={`focus-${focus.value}`} className="ml-2 text-sm text-gray-700">
                {focus.label}
              </label>
            </div>
          ))}
        </div>
      </FilterSection>

      <FilterSection title="Location">
        <div className="max-h-40 overflow-y-auto">
          {states.slice(0, 10).map((state) => (
            <div key={state} className="flex items-center">
              <input
                type="checkbox"
                id={`state-${state}`}
                checked={selectedLocations.includes(state)}
                onChange={() => {
                  const newLocations = selectedLocations.includes(state)
                    ? selectedLocations.filter(l => l !== state)
                    : [...selectedLocations, state];
                  onLocationChange(newLocations);
                }}
                className="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              />
              <label htmlFor={`state-${state}`} className="ml-2 text-sm text-gray-700">
                {state}
              </label>
            </div>
          ))}
        </div>
      </FilterSection>

      <FilterSection title="Minimum Rating">
        <select
          value={selectedRating}
          onChange={(e) => onMinRatingChange(e.target.value)}
          className="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
        >
          {ratingOptions.map((option) => (
            <option key={option.value} value={option.value}>
              {option.label}
            </option>
          ))}
        </select>
      </FilterSection>

      <FilterSection title="Veteran Founded">
        <div className="flex items-center">
          <button
            onClick={() => onVeteranFoundedChange(!isVeteranFounded)}
            className={`relative inline-flex h-6 w-11 items-center rounded-full ${isVeteranFounded ? 'bg-blue-600' : 'bg-gray-200'}`}
          >
            <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${isVeteranFounded ? 'translate-x-6' : 'translate-x-1'}`} />
          </button>
          <span className="ml-2 text-sm text-gray-700">
            {isVeteranFounded ? 'Only Veteran Founded' : 'All Organizations'}
          </span>
        </div>
      </FilterSection>

      <FilterSection title="Verified Status">
        <div className="flex items-center">
          <button
            onClick={() => onVerifiedOnlyChange(!showAllResources)}
            className={`relative inline-flex h-6 w-11 items-center rounded-full ${!showAllResources ? 'bg-blue-600' : 'bg-gray-200'}`}
          >
            <span className={`inline-block h-4 w-4 transform rounded-full bg-white transition ${!showAllResources ? 'translate-x-6' : 'translate-x-1'}`} />
          </button>
          <span className="ml-2 text-sm text-gray-700">
            {!showAllResources ? 'Only Verified' : 'All Organizations'}
          </span>
        </div>
      </FilterSection>

      <FilterSection title="Sort By">
        <select
          value="relevance" // Default value
          onChange={(e) => onSortByChange(e.target.value)}
          className="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"
        >
          {sortOptions.map((option) => (
            <option key={option.value} value={option.value}>
              {option.label}
            </option>
          ))}
        </select>
      </FilterSection>
    </div>
  );
};

export default NGOFilters;
